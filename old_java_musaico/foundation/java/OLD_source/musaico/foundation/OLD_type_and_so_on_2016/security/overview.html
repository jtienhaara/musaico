<html>
<body>
  <p>
    Provides a lightweight and abstract
    framework for security configurations, from simple UNIX-style
    user/group/other read/write/execute permissions,
    to capabilities, to access control lists.
  </p>

  <p>
    The framework allows an external party to request certain
    permissions based on their credentials and, depending on
    what they are allowed to do in the environment, the appropriate
    permissions will be returned.
  </p>

  <p>
    For example, permission to overwrite the "last_name" field
    in a "customer" object might be requested as follows:
  </p>

  <pre>
    Customer customer = ...;
    Credentials my_credentials = ...;
    Permissions requested_permissions =
        new UNIXPermissions ( my_credentials, UNIXPermissions.WRITE );

    Security security = customer.security ();
    Permissions granted_permissions =
        security.request ( requested_permissions );

    customer.setLastName ( granted_permissions, "Rumpelstiltskin" );
  </pre>

  <p>
    If multiple operations are to be performed on the same object,
    then storing the granted permissions and re-using them for
    each subsequent method call is a wise approach.
    However if only one operation is to be performed on an object,
    then the code can be compacted somewhat by leaving out
    the explicit Permissions request, and letting the object
    deal with its own Security layer.  For example:
  </p>

  <pre>
    Customer customer = ...;
    Credentials my_credentials = ...;
    Permissions requested_permissions =
        new UNIXPermissions ( my_credentials, UNIXPermissions.WRITE );

    customer.setLastName ( requested_permissions, "Rumpelstiltskin" );
  </pre>

  <p>
    This code has the same effect as the first example, since
    the customer object must always convert the requested
    permissions into granted permissions before proceeding
    with the "setLastName" operation.
  </p>

  <p>
    An object which provides a security layer might be implemented
    as follows:
  </p>

  <pre>
    public class Customer
    {
        private final Security =
            new SimpleSecurityBuilder ()
                .unixOwner ( ...credentials... )
                .unixGroup ( ...credentials... )
                .unixPermissions ( "rw-r--r--" );

        private final Object lock = new Object ();

        private String firstName;

        private String lastName;

        public String getFirstName ( Permissions requested_permissions )
            throws PermissionDeniedRuntimeException
        {
            Permissions granted_permissions =
                this.security ().request ( requested_permissions );

            if ( ! granted_permissions.isAllowed ( UnixPermissions.READ ) )
            {
                throw new PermissionDeniedRuntimeException ( ... );
            }

            return this.firstName;
        }

        public void setFirstName ( Permissions requested_permissions,
                                   String first_name )
            throws PermissiondeniedRuntimeException
        {
            Permissions granted_permissions =
                this.security ().request ( requested_permissions );

            if ( ! granted_permissions.isAllowed ( UnixPermissions.READ ) )
            {
                throw new PermissionDeniedRuntimeException ( ... );
            }

            synchronized ( this.lock )
            {
                this.firstName = first_name;
            }
        }

        ... and so on for getLastName () and setLastName ( String ) ...
    }
  </pre>


  <br> </br>
  <br> </br>
  <hr> </hr>
  <br> </br>
  <br> </br>


  <pre>
    Copyright (c) 2009-2018 Johann Tienhaara <jtienhaara@yahoo.com>
    All rights reserved.

    This file is part of Musaico.

    Musaico is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    Musaico is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with Musaico.  If not, see <http://www.gnu.org/licenses/>.
  </pre>
</body>
</html>
